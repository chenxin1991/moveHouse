<view class='productSort'>
	<view class='aside'>
		<block wx:for="{{products}}" wx:for-item="item" wx:key>
			<view class='item {{index==navActive?"on":""}}' data-index='{{index}}' data-id='b{{index}}' bindtap='tap'>
				<text>{{item.name}}
				<block wx:if="{{item.is_free && carNum>0}}">（{{carNum}}车内免费）</block>
				</text>
			</view>
		</block>
	</view>
	<view class='conter'>
		<scroll-view scroll-y="true" scroll-into-view="{{toView}}" style='height:{{height}}rpx;' bindscroll="scroll" scroll-with-animation='true'>
			<block wx:for="{{products}}" wx:for-item="product" wx:for-index="idx">
				<view class='listw' id="b{{idx}}">
					<view class='title'>
						<view class='name'>{{product.name}}</view>
					</view>
					<block wx:if="{{idx == 1}}">
						<view class="special">
							<view class="appoint">
								<text>预约时间</text>
								<picker mode="date" value="{{appointDate}}" start="{{startDate}}" end="{{endDate}}" bindchange="bindDateChange">
									<input class="date" disabled="true" placeholder="请选择日期" value="{{appointDate}}" />
								</picker>
								<picker bindchange="bindPickerChange" value="{{appointTime}}" range="{{timeArray}}">
									<input class="time" disabled="true" placeholder="请选择时间" value="{{timeArray[appointTime]}}" />
								</picker>
							</view>
							<view catchtap='addFrom' data-url="pages/addressFrom/addressFrom">
								<view class="address">
									<view class="left">
										<view>
											<image src='/images/qidian.png' class="icon"></image>
										</view>
										<block wx:if="{{flagFrom}}">
											<view class="detail">
												<view class="detail1"><text class="name">{{addressFrom.address.name}} {{addressFrom.room_number}}</text></view>
												<view class="detail2"><text>{{array1[addressFrom.stairs_or_elevators]}}：{{addressFrom.floor_num}}层</text><text class="pl30">停车位距离：{{array2[addressFrom.parking_distance]}}</text></view>
											</view>
										</block>
										<block wx:else>
											<text class="choose">请选择从哪里搬出</text>
										</block>
									</view>
									<view class="right">
										<image src='/images/dayu.png' class="dayu"></image>
									</view>
								</view>
							</view>
							<view catchtap='addTo' data-url="pages/addressTo/addressTo">
								<view class="address">
									<view class="left">
										<view>
											<image src='/images/zhongdian.png' class="icon"></image>
										</view>
										<block wx:if="{{flagTo}}">
											<view class="detail">
												<view class="detail1"><text class="name">{{addressTo.address.name}} {{addressTo.room_number}}</text></view>
												<view class="detail2"><text>{{array1[addressTo.stairs_or_elevators]}}：{{addressTo.floor_num}}层</text><text class="pl30">停车位距离：{{array2[addressTo.parking_distance]}}</text></view>
											</view>
										</block>
										<block wx:else>
											<text class="choose">请选择搬到哪里</text>
										</block>
									</view>
									<view class="right">
										<image src='/images/dayu.png' class="dayu"></image>
									</view>
								</view>
							</view>
							<view class="result">
								<text>行驶距离：<text class="distance">{{distance}}公里</text></text>
							</view>
						</view>
					</block>
					<view class='goodList'>
						<block wx:for="{{product.goods}}" wx:for-index="idy">
							<view class='item'>
								<view class='pictrue' wx:if="{{idx==0}}">
									<image src='{{item.image_url}}' mode='aspectFill'></image>
								</view>
								<block wx:if="{{idx!=0}}">
									<block wx:if="{{item.images.length==1}}">
										<view class='pictrue'>
											<image src='{{item.images[0].url}}' mode='aspectFill'></image>
										</view>
									</block>
									<block wx:else>
										<swiper class='pictrue' indicator-dots="true" data-idx='{{idx}}' data-idy="{{idy}}" bindchange="test">
											<block wx:for="{{item.images}}" wx:key='index'>
												<swiper-item>
													<image src="{{item.url}}"></image>
												</swiper-item>
											</block>
										</swiper>
									</block>
								</block>
								<view class='underline'>
									<view class='text'>
										<view class='title'>{{item.name}}</view>
										<view class="content">
											<view class='money'>￥<text class='num'>{{item.price}}</text></view>
											<view class="changeNum" wx:if="{{!product.is_free}}">
												<image catchtap='addCart' data-idx='{{idx}}' data-idy="{{idy}}" src='/images/add.png' class="icon"></image>
											</view>
										</view>
									</view>
								</view>
							</view>
						</block>
					</view>
				</view>
			</block>
			<view style='height:{{height-300}}rpx;'></view>
		</scroll-view>
	</view>
	<view class='footer' catchtouchmove="true" wx:if="{{total}}">
		<view class="left">
			<view class="cart" catchtap='showProduct'>
				<view class="num">
					<text>{{total}}</text>
				</view>
				<image src="/images/cart.png" style='width:60rpx;height:60rpx;'></image>
			</view>
			<view style="margin-left:20rpx;">
				<text class='money'>￥100.00</text>
			</view>
		</view>
		<view>
			<button class='balance' catchtap="toOrder">去结算</button>
		</view>
	</view>
</view>

<view class="address-window {{show==true?'on':''}}" catchtouchmove='ture' wx:if="{{total}}">
	<!-- <view class='title'>
		<text>物品信息</text>
		<image src='/images/close.png' style='width:28rpx;height:28rpx;position: absolute;left: 30rpx;top:26rpx;padding:10rpx 10rpx;' bindtap='closeProduct'></image>
	</view> -->
	<view style="padding:20rpx 30rpx;display:flex;flex-wrap:wrap;justify-content:space-between;">
		<view><text style="font-size:30rpx;">共{{total}}件物品</text></view>
		<view style="color:#999;font-size:26rpx;" catchtap='clearProduct'>清空购物车</view>
	</view>
	<scroll-view scroll-y="true" style="max-height: 640rpx;">
		<view wx:for="{{cart}}" style="padding:0rpx 30rpx;">
			<view style="height:180rpx;display:flex;align-items:center;flex-direction:row;background: #f1f1f1;padding:15rpx 15rpx;margin-bottom:20rpx;" catchtap='showProduct'>
				<view style="height:100%;width:80%;display:flex;flex-direction: row;">
					<view>
						<image src='{{item.image_url}}' mode='aspectFill' style='width:150rpx;height:150rpx;margin-right:15rpx;'></image>
					</view>
					<view style="word-wrap: break-word;word-break: normal;">{{item.name}}</view>
				</view>
				<view style="display:flex;height:100%;width:20%;flex-direction:column;align-items:flex-end;">
					<text>￥{{item.price}}</text>
					<text>x{{item.num}}</text>
				</view>
			</view>
		</view>
	</scroll-view>
</view>
<view class='mask' catchtouchmove="true" hidden='{{show==false}}' bindtap='closeProduct'></view>